#include QMK_KEYBOARD_H

extern keymap_config_t keymap_config;

#define _QWERTY 0
#define _LOWER 1
#define _RAISE 2
#define _ADJUST 16

enum custom_keycodes {
  QWERTY = SAFE_RANGE,
  LOWER,
  RAISE,
  ADJUST,
};

#define _______________________LAYER1_L1_______________________ ESC,          1,          2,          3,          4,          5
#define _______________________LAYER1_L2_______________________ TAB,          Q,          W,          E,          R,          T
#define _______________________LAYER1_L3_______________________ LCTL,         A,          S,          D,          F,          G
#define _______________________LAYER1_L4_______________________ LSFT,         Z,          X,          C,          V,          B,          LOWER
#define _______________________LAYER1_L5_______________________ LGUI,         LALT,       SPC,

#define _______________________LAYER1_R1_______________________ 6,            7,          8,          9,          0,          BSPC
#define _______________________LAYER1_R2_______________________ Y,            U,          I,          O,          P,          DEL
#define _______________________LAYER1_R3_______________________ H,            J,          K,          L,          SCLN,       QUOT
#define _______________________LAYER1_R4_______________________ RAISE,        N,          M,          COMM,       DOT,        SLSH,       RSFT
#define _______________________LAYER1_R5_______________________ SPC,          MEH,        ENT

// Text navigation
#define _______________________LAYER2_L1_______________________ ESC,          MUTE,       VOLD,       VOLU,       MPLY,       5
#define _______________________LAYER2_L2_______________________ TAB,          HOME,       UP,         END,        PGUP,       T
#define _______________________LAYER2_L3_______________________ LCTL,         LEFT,       DOWN,       RGHT,       PGDN,       G
#define _______________________LAYER2_L4_______________________ LSFT,         Z,          X,          C,          V,          B,          LOWER
#define _______________________LAYER2_L5_______________________ LGUI,         LALT,       SPC,

#define _______________________LAYER2_R1_______________________ 6,            7,          8,          9,          10,         BSPC
#define _______________________LAYER2_R2_______________________ GRV,          BSLS,       TILD,       LPRN,       RPRN,       DEL
#define _______________________LAYER2_R3_______________________ LBRC,         RBRC,       LCBR,       RCBR,       SCLN,       QUOT
#define _______________________LAYER2_R4_______________________ RAISE,        MINS,       EQL,        PLUS,       DOT,        SLSH,       RSFT
#define _______________________LAYER2_R5_______________________ SPC,          MEH,        ENT

#define _______________________LAYER3_L1_______________________ ESC,          F1,         F2,         F3,         F4,         F5
#define _______________________LAYER3_L2_______________________ TAB,          HYPR(Q),    HYPR(W),    HYPR(E),    HYPR(R),    HYPR(T)
#define _______________________LAYER3_L3_______________________ LCTL,         HYPR(A),    HYPR(S),    HYPR(D),    HYPR(F),    HYPR(G)
#define _______________________LAYER3_L4_______________________ LSFT,         HYPR(Z),    HYPR(X),    HYPR(C),    HYPR(V),    HYPR(B),    LOWER
#define _______________________LAYER3_L5_______________________ LGUI,         LALT,       SPC,

#define _______________________LAYER3_R1_______________________ F6,           F7,         F8,         F9,         F10,        BSPC
#define _______________________LAYER3_R2_______________________ F11,          F12,        HYPR(I),    HYPR(O),    HYPR(P),    DEL
#define _______________________LAYER3_R3_______________________ HYPR(H),      HYPR(J),    HYPR(K),    HYPR(L),    HYPR(SCLN), HYPR(QUOT)
#define _______________________LAYER3_R4_______________________ RAISE,        HYPR(N),    HYPR(M),    HYPR(COMM), HYPR(DOT),  HYPR(SLSH), RSFT
#define _______________________LAYER3_R5_______________________ SPC,          MEH,        ENT

#define LOWER  TO(_LOWER)
#define RAISE  TO(_RAISE)
#define ADJUST TO(_ADJUST)

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
  [_QWERTY] = LAYOUT_kc(
//   //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
//     _______________________LAYER1_L1_______________________,                         _______________________LAYER1_R1_______________________,
//   //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
//     _______________________LAYER1_L2_______________________,                         _______________________LAYER1_R2_______________________,
//   //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
//     _______________________LAYER1_L3_______________________,                         _______________________LAYER1_R3_______________________,
//   //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
//     _______________________LAYER1_L4_______________________,                         _______________________LAYER1_R4_______________________,
//   //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
//     _______________________LAYER1_L5_______________________,                         _______________________LAYER1_R5_______________________
//                                 // └────────┴────────┴────────┘                 └────────┴────────┴────────┘
        ESC,          1,          2,          3,          4,          5,                        6,            7,          8,          9,          0,          BSPC,
        TAB,          Q,          W,          E,          R,          T,                        Y,            U,          I,          O,          P,          DEL,
        LCTL,         A,          S,          D,          F,          G,                        H,            J,          K,          L,          SCLN,       QUOT,
        LSFT,         Z,          X,          C,          V,          B,        LOWER,          RAISE,        N,          M,          COMM,       DOT,        SLSH,       RSFT,
                                            LGUI,       LALT,     SPC,                          SPC,          MEH,        ENT
),

  [_LOWER] = LAYOUT(
//   //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
//     _______________________LAYER2_L1_______________________,                         _______________________LAYER2_R1_______________________,
//   //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
//     _______________________LAYER2_L2_______________________,                         _______________________LAYER2_R2_______________________,
//   //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
//     _______________________LAYER2_L3_______________________,                         _______________________LAYER2_R3_______________________,
//   //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
//     _______________________LAYER2_L4_______________________,                         _______________________LAYER2_R4_______________________,
//   //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
//     _______________________LAYER2_L5_______________________,                         _______________________LAYER2_R5_______________________
//                                 // └────────┴────────┴────────┘                 └────────┴────────┴────────┘
        ESC,          MUTE,       VOLD,       VOLU,       MPLY,       5,                        6,            7,          8,          9,          10,         BSPC,
        TAB,          HOME,       UP,         END,        PGUP,       T,                        GRV,          BSLS,       TILD,       LPRN,       RPRN,       DEL,
        LCTL,         LEFT,       DOWN,       RGHT,       PGDN,       G,                        LBRC,         RBRC,       LCBR,       RCBR,       SCLN,       QUOT,
        LSFT,         Z,          X,          C,          V,          B,        LOWER,          RAISE,        MINS,       EQL,        PLUS,       DOT,        SLSH,       RSFT,
                                              LGUI,       LALT,     SPC,                        SPC,          MEH,        ENT

  ),

  [_RAISE] = LAYOUT(
//   //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
//     _______________________LAYER3_L1_______________________,                         _______________________LAYER3_R1_______________________
//   //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
//     _______________________LAYER3_L2_______________________,                         _______________________LAYER3_R2_______________________
//   //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
//     _______________________LAYER3_L3_______________________,                         _______________________LAYER3_R3_______________________
//   //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
//     _______________________LAYER3_L4_______________________,                         _______________________LAYER3_R4_______________________
//   //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
//     _______________________LAYER3_L5_______________________,                         _______________________LAYER3_R5_______________________
//                                 // └────────┴────────┴────────┘                 └────────┴────────┴────────┘
        ESC,          F1,         F2,         F3,         F4,         F5,                   F6,           F7,         F8,         F9,         F10,        BSPC,
        TAB,          HYPR(Q),    HYPR(W),    HYPR(E),    HYPR(R),    HYPR(T),              F11,          F12,        HYPR(I),    HYPR(O),    HYPR(P),    DEL,
        LCTL,         HYPR(A),    HYPR(S),    HYPR(D),    HYPR(F),    HYPR(G),              HYPR(H),      HYPR(J),    HYPR(K),    HYPR(L),    HYPR(SCLN), HYPR(QUOT),
        LSFT,         HYPR(Z),    HYPR(X),    HYPR(C),    HYPR(V),    HYPR(B),    LOWER,    RAISE,        HYPR(N),    HYPR(M),    HYPR(COMM), HYPR(DOT),  HYPR(SLSH), RSFT
                                              LGUI,       LALT,       SPC,                  SPC,          MEH,        ENT
  ),

  [_ADJUST] = LAYOUT(
  //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
     _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
     _______, _______, _______, _______, _______, _______, _______,          _______, _______, _______, _______, _______, _______, _______,
  //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                    _______, _______, _______,                   _______, _______, _______
                                // └────────┴────────┴────────┘                 └────────┴────────┴────────┘
  )
};

bool process_record_user(uint16_t keycode, keyrecord_t *record) {
  switch (keycode) {
    case QWERTY:
      if (record->event.pressed) {
        set_single_persistent_default_layer(_QWERTY);
      }
      return false;
      break;
    case LOWER:
      if (record->event.pressed) {
        layer_on(_LOWER);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      } else {
        layer_off(_LOWER);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      }
      return false;
      break;
    case RAISE:
      if (record->event.pressed) {
        layer_on(_RAISE);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      } else {
        layer_off(_RAISE);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      }
      return false;
      break;
    case ADJUST:
      if (record->event.pressed) {
        layer_on(_ADJUST);
      } else {
        layer_off(_ADJUST);
      }
      return false;
      break;
  }
  return true;
}
